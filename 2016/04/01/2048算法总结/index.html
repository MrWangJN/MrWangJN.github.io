<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    

    <title>
       | 橙子先生的小站 
    </title>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    
      <meta name="author" content="Wang JianNan">
    
    

    <meta name="description" content="title: 2048算法总结date: 2016-04-01 17:08:08tags:
关于2048这款小游戏，网络上的算法笔笔皆是，我在Xcode平台上用更偏近于C的语法简单的实现了一下，仅供参考。说先创建一个game类123456789101112131415161718192021222324252627282930313233343536373839404142434445464748">
<meta property="og:type" content="article">
<meta property="og:title" content=" | 橙子先生的小站">
<meta property="og:url" content="http://orangeman.online/2016/04/01/2048算法总结/index.html">
<meta property="og:site_name" content="橙子先生的小站">
<meta property="og:description" content="title: 2048算法总结date: 2016-04-01 17:08:08tags:
关于2048这款小游戏，网络上的算法笔笔皆是，我在Xcode平台上用更偏近于C的语法简单的实现了一下，仅供参考。说先创建一个game类123456789101112131415161718192021222324252627282930313233343536373839404142434445464748">
<meta property="og:updated_time" content="2016-04-01T09:08:36.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content=" | 橙子先生的小站">
<meta name="twitter:description" content="title: 2048算法总结date: 2016-04-01 17:08:08tags:
关于2048这款小游戏，网络上的算法笔笔皆是，我在Xcode平台上用更偏近于C的语法简单的实现了一下，仅供参考。说先创建一个game类123456789101112131415161718192021222324252627282930313233343536373839404142434445464748">
    
    
    
      <link rel="icon" type="image/x-icon" href="/favicon.png">
    
    <link rel="stylesheet" href="/css/uno.css" type="text/css">
    <link rel="stylesheet" href="/css/highlight.css" type="text/css">
    <link rel="stylesheet" href="/css/archive.css" type="text/css">
    <link rel="stylesheet" href="/css/china-social-icon.css" type="text/css">

</head>
<body>

    <span class="mobile btn-mobile-menu">
        <i class="icon icon-list btn-mobile-menu__icon"></i>
        <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
    </span>

    

<header class="panel-cover panel-cover--collapsed">


  <div class="panel-main">

  
    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">

        

        <h1 class="panel-cover__title panel-title"><a href="/" title="link to homepage">橙子先生的小站</a></h1>
        <hr class="panel-cover__divider" />

        

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">

              
                
                <li class="navigation__item"><a href="/#blog" title="" class="blog-button">首页</a></li>
              
                
                <li class="navigation__item"><a href="/about" title="" class="">关于</a></li>
              
                
                <li class="navigation__item"><a href="/archive" title="" class="">归档</a></li>
              

            </ul>
          </nav>

          <!-- ----------------------------
To add a new social icon simply duplicate one of the list items from below
and change the class in the <i> tag to match the desired social network
and then add your link to the <a>. Here is a full list of social network
classes that you can use:

    icon-social-500px
    icon-social-behance
    icon-social-delicious
    icon-social-designer-news
    icon-social-deviant-art
    icon-social-digg
    icon-social-dribbble
    icon-social-facebook
    icon-social-flickr
    icon-social-forrst
    icon-social-foursquare
    icon-social-github
    icon-social-google-plus
    icon-social-hi5
    icon-social-instagram
    icon-social-lastfm
    icon-social-linkedin
    icon-social-medium
    icon-social-myspace
    icon-social-path
    icon-social-pinterest
    icon-social-rdio
    icon-social-reddit
    icon-social-skype
    icon-social-spotify
    icon-social-stack-overflow
    icon-social-steam
    icon-social-stumbleupon
    icon-social-treehouse
    icon-social-tumblr
    icon-social-twitter
    icon-social-vimeo
    icon-social-xbox
    icon-social-yelp
    icon-social-youtube
    icon-social-zerply
    icon-mail

-------------------------------->

<!-- add social info here -->



        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>

    <div class="content-wrapper">
        <div class="content-wrapper__inner entry">
            

<article class="post-container post-container--single">

  <header class="post-header">
    
    <h1 class="post-title"></h1>

    

    <div class="post-meta">
      <time datetime="2016-04-01" class="post-meta__date date">2016-04-01</time> 

      <span class="post-meta__tags tags">

          

          

      </span>
    </div>
    
    

  </header>

  <section id="post-content" class="article-content post">
    <p>title: 2048算法总结<br>date: 2016-04-01 17:08:08<br>tags:</p>
<h1 id="u5173_u4E8E2048_u8FD9_u6B3E_u5C0F_u6E38_u620F_uFF0C_u7F51_u7EDC_u4E0A_u7684_u7B97_u6CD5_u7B14_u7B14_u7686_u662F_uFF0C_u6211_u5728Xcode_u5E73_u53F0_u4E0A_u7528_u66F4_u504F_u8FD1_u4E8EC_u7684_u8BED_u6CD5_u7B80_u5355_u7684_u5B9E_u73B0_u4E86_u4E00_u4E0B_uFF0C_u4EC5_u4F9B_u53C2_u8003_u3002"><a href="#u5173_u4E8E2048_u8FD9_u6B3E_u5C0F_u6E38_u620F_uFF0C_u7F51_u7EDC_u4E0A_u7684_u7B97_u6CD5_u7B14_u7B14_u7686_u662F_uFF0C_u6211_u5728Xcode_u5E73_u53F0_u4E0A_u7528_u66F4_u504F_u8FD1_u4E8EC_u7684_u8BED_u6CD5_u7B80_u5355_u7684_u5B9E_u73B0_u4E86_u4E00_u4E0B_uFF0C_u4EC5_u4F9B_u53C2_u8003_u3002" class="headerlink" title="关于2048这款小游戏，网络上的算法笔笔皆是，我在Xcode平台上用更偏近于C的语法简单的实现了一下，仅供参考。"></a>关于2048这款小游戏，网络上的算法笔笔皆是，我在Xcode平台上用更偏近于C的语法简单的实现了一下，仅供参考。</h1><h2 id="u8BF4_u5148_u521B_u5EFA_u4E00_u4E2Agame_u7C7B"><a href="#u8BF4_u5148_u521B_u5EFA_u4E00_u4E2Agame_u7C7B" class="headerlink" title="说先创建一个game类"></a>说先创建一个game类</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="string">"game.h"</span>  </span></span><br><span class="line">  </span><br><span class="line">@implementation game  </span><br><span class="line">@synthesize n=_n,count=_count,filePath;  </span><br><span class="line">-(id)initWithfirst:(<span class="keyword">int</span>)num <span class="comment">//初始化  </span></span><br><span class="line">&#123;  </span><br><span class="line">    self = [super init];  </span><br><span class="line">    n = num &gt;= <span class="number">2</span> &amp;&amp; num &lt;= <span class="number">10</span> ? num : <span class="number">4</span>;  </span><br><span class="line">    a = (intint **)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>*) * n);  </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++) &#123;  </span><br><span class="line">        a[i] = (intint *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * n);  </span><br><span class="line">        <span class="built_in">memset</span>(a[i], <span class="number">0</span>, <span class="keyword">sizeof</span>(<span class="keyword">int</span>) * n);  </span><br><span class="line">    &#125;  </span><br><span class="line">    count = n * n - <span class="number">2</span>;  </span><br><span class="line">      </span><br><span class="line">    [self randset];  </span><br><span class="line">    [self randset];  </span><br><span class="line">    <span class="keyword">return</span>  self;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)randset <span class="comment">//产生随机数  </span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> == count)  </span><br><span class="line">        <span class="keyword">return</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> Max = <span class="number">0.5</span>;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">int</span> randnum = rand()%(n*n);  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">while</span> (a[randnum/n][randnum%n])  </span><br><span class="line">        randnum = rand()%(n*n);  </span><br><span class="line">      </span><br><span class="line">    a[randnum/n][randnum%n] = (rand() * <span class="number">1.0</span>/RAND_MAX&lt;Max) ? <span class="number">2</span> : <span class="number">4</span>;  </span><br><span class="line">    count--;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)dealloc<span class="comment">//释放  </span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)  </span><br><span class="line">        <span class="built_in">free</span>(a[i]);  </span><br><span class="line">    <span class="built_in">free</span>(a);  </span><br><span class="line">    [super  dealloc];  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(BOOL)move:(<span class="keyword">int</span>)m  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">int</span> count0 = <span class="number">0</span>;  </span><br><span class="line">    flag = NO;  </span><br><span class="line">      </span><br><span class="line">    <span class="keyword">if</span>(<span class="number">1</span> == m) &#123;<span class="comment">//up  </span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; n;j++) &#123;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">int</span> i;  </span><br><span class="line">            <span class="keyword">int</span> old = -<span class="number">1</span>;  </span><br><span class="line">            <span class="keyword">int</span> w = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; n;i++)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j]) &#123;  </span><br><span class="line">                    <span class="keyword">if</span>(w != i) flag = YES;  </span><br><span class="line">                    a[w++][j] = a[i][j];  </span><br><span class="line">                &#125;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">while</span>(w &lt; n)  </span><br><span class="line">                a[w++][j] = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; n;i++)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j]!=old) &#123;  </span><br><span class="line">                    old=a[i][j];  </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">                    a[i-<span class="number">1</span>][j] *= <span class="number">2</span>;  </span><br><span class="line">                    <span class="keyword">if</span>(a[i-<span class="number">1</span>][j])flag = YES;  </span><br><span class="line">                    a[i][j] = <span class="number">0</span>;  </span><br><span class="line">                    old = -<span class="number">1</span>;  </span><br><span class="line">                &#125;  </span><br><span class="line">              </span><br><span class="line">            w = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; n;i++)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j])  </span><br><span class="line">                    a[w++][j] = a[i][j];  </span><br><span class="line">            count0 += n - w;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">while</span>(w &lt; n)  </span><br><span class="line">                a[w++][j] = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span>(<span class="number">2</span> == m) &#123;<span class="comment">//down  </span></span><br><span class="line">      </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>;j &lt; n;j++)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">int</span> i;  </span><br><span class="line">            <span class="keyword">int</span> old = -<span class="number">1</span>;  </span><br><span class="line">            <span class="keyword">int</span> w = n - <span class="number">1</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(i = n - <span class="number">1</span>;i &gt;= <span class="number">0</span>;i--)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j]) &#123;  </span><br><span class="line">                    <span class="keyword">if</span>(w != i) flag = YES;  </span><br><span class="line">                    a[w--][j] = a[i][j];  </span><br><span class="line">                &#125;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">while</span>(w &gt;= <span class="number">0</span>)  </span><br><span class="line">                a[w--][j] = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(i = n - <span class="number">1</span>;i &gt;= <span class="number">0</span>;i--)  </span><br><span class="line">                  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j] != old) &#123;  </span><br><span class="line">                    old = a[i][j];  </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">                    a[i+<span class="number">1</span>][j] *= <span class="number">2</span>;  </span><br><span class="line">                      </span><br><span class="line">                    <span class="keyword">if</span>(a[i+<span class="number">1</span>][j]) flag = YES;  </span><br><span class="line">                      </span><br><span class="line">                    a[i][j] = <span class="number">0</span>;  </span><br><span class="line">                    old = -<span class="number">1</span>;  </span><br><span class="line">                &#125;  </span><br><span class="line">            w = n-<span class="number">1</span>;  </span><br><span class="line">            <span class="keyword">for</span>(i = n - <span class="number">1</span>;i &gt;= <span class="number">0</span>;i--)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j])  </span><br><span class="line">                    a[w--][j] = a[i][j];  </span><br><span class="line">            count0 += w+<span class="number">1</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">while</span>(w &gt;= <span class="number">0</span>)  </span><br><span class="line">                a[w--][j] = <span class="number">0</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span>(<span class="number">3</span> == m)<span class="comment">//left  </span></span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">int</span> j;  </span><br><span class="line">            <span class="keyword">int</span> old = -<span class="number">1</span>;  </span><br><span class="line">            <span class="keyword">int</span> w = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; n;j++)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j])  </span><br><span class="line">                &#123;  </span><br><span class="line">                    <span class="keyword">if</span> (w != j)  </span><br><span class="line">                        flag = YES;  </span><br><span class="line">                    a[i][w++] = a[i][j];  </span><br><span class="line">                &#125;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">while</span>(w &lt; n)  </span><br><span class="line">                a[i][w++] = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; n;j++)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j] != old) &#123;  </span><br><span class="line">                    old = a[i][j];  </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">                    a[i][j-<span class="number">1</span>] *= <span class="number">2</span>;  </span><br><span class="line">                      </span><br><span class="line">                    <span class="keyword">if</span>(a[i][j-<span class="number">1</span>])   flag = YES;  </span><br><span class="line">                      </span><br><span class="line">                    a[i][j] = <span class="number">0</span>;  </span><br><span class="line">                    old = -<span class="number">1</span>;  </span><br><span class="line">                &#125;  </span><br><span class="line">              </span><br><span class="line">            w = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; n;j++)  </span><br><span class="line">                  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j])  </span><br><span class="line">                    a[i][w++] = a[i][j];  </span><br><span class="line">              </span><br><span class="line">            count0 += n - w;  </span><br><span class="line">            <span class="keyword">while</span>(w &lt; n)  </span><br><span class="line">                a[i][w++] = <span class="number">0</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span>(<span class="number">4</span> == m)<span class="comment">//right  </span></span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i++)  </span><br><span class="line">        &#123;  </span><br><span class="line">            <span class="keyword">int</span> j;  </span><br><span class="line">            <span class="keyword">int</span> old = - <span class="number">1</span>;  </span><br><span class="line">            <span class="keyword">int</span> w = n - <span class="number">1</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(j = n - <span class="number">1</span>;j &gt;= <span class="number">0</span>;j--)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j]) &#123;  </span><br><span class="line">                    <span class="keyword">if</span>(w != j) flag = YES;  </span><br><span class="line">                    a[i][w--] = a[i][j];  </span><br><span class="line">                &#125;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">while</span>(w &gt;= <span class="number">0</span>)  </span><br><span class="line">                a[i][w--] = <span class="number">0</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(j = n-<span class="number">1</span>;j &gt;= <span class="number">0</span>;j--)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j] != old) &#123;  </span><br><span class="line">                    old = a[i][j];  </span><br><span class="line">                &#125; <span class="keyword">else</span>  &#123;  </span><br><span class="line">                    <span class="keyword">if</span>(a[i][j+<span class="number">1</span>])  </span><br><span class="line">                        flag = YES;  </span><br><span class="line">                      </span><br><span class="line">                    a[i][j+<span class="number">1</span>] *= <span class="number">2</span>;  </span><br><span class="line">                    a[i][j] = <span class="number">0</span>;  </span><br><span class="line">                    old = -<span class="number">1</span>;  </span><br><span class="line">                &#125;  </span><br><span class="line">              </span><br><span class="line">            w = n - <span class="number">1</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">for</span>(j = n - <span class="number">1</span>;j &gt;= <span class="number">0</span>;j--)  </span><br><span class="line">                <span class="keyword">if</span>(a[i][j])  </span><br><span class="line">                    a[i][w--] = a[i][j];  </span><br><span class="line">            count0 += w+<span class="number">1</span>;  </span><br><span class="line">              </span><br><span class="line">            <span class="keyword">while</span>(w &gt;= <span class="number">0</span>)  </span><br><span class="line">                a[i][w--] = <span class="number">0</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    count = count0;  </span><br><span class="line">    <span class="keyword">if</span>(flag==YES) [self randset];  </span><br><span class="line">    <span class="keyword">return</span> [self game_over];  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)initWithFile  </span><br><span class="line">&#123;  </span><br><span class="line">    self=[super init];  </span><br><span class="line">    NSArray* dirArray = NSSearchPathForDirectoriesInDomains(  </span><br><span class="line">                                                            NSDocumentDirectory, NSUserDomainMask, YES);  </span><br><span class="line">    NSString* documentsDirPath = [dirArray objectAtIndex:<span class="number">0</span>];  </span><br><span class="line">    <span class="comment">//设置归档文件的全路径  </span></span><br><span class="line">    filePath = [documentsDirPath stringByAppendingPathComponent:@<span class="string">"2048.archive"</span>];  </span><br><span class="line">    NSArray* arr=[NSArray arrayWithContentsOfFile:filePath];<span class="comment">//@"/tmp/2048.txt"];  </span></span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;  </span><br><span class="line">    NSNumber *tmp;  </span><br><span class="line"><span class="comment">//    tmp=[arr objectAtIndex:i++];  </span></span><br><span class="line"><span class="comment">//    n=[tmp intValue];  </span></span><br><span class="line">    tmp=[arr objectAtIndex:i++];  </span><br><span class="line">    sco=[tmp intValue];   <span class="comment">//提取最高分数  </span></span><br><span class="line">      </span><br><span class="line"><span class="comment">//    a=(int**)malloc(sizeof(int*)*n);  </span></span><br><span class="line"><span class="comment">//    for(int j=0;j&lt;n;j++)  </span></span><br><span class="line"><span class="comment">//        a[j]=(int*)malloc(sizeof(int)*n);  </span></span><br><span class="line"><span class="comment">//    for(i=0;i&lt;n*n;i++)      //此处可以实现暂停功能  </span></span><br><span class="line"><span class="comment">//    &#123;  </span></span><br><span class="line"><span class="comment">//        tmp=[arr objectAtIndex:i+3];  </span></span><br><span class="line"><span class="comment">//        a[i/n][i%n]=[tmp intValue];  </span></span><br><span class="line"><span class="comment">//    &#125;  </span></span><br><span class="line">    <span class="comment">//return self;  </span></span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)write_to_file  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="comment">//@"/tmp/2048.txt";  </span></span><br><span class="line">    self=[super init];  </span><br><span class="line">    NSArray* dirArray = NSSearchPathForDirectoriesInDomains(  </span><br><span class="line">                                                            NSDocumentDirectory, NSUserDomainMask, YES);  </span><br><span class="line">    NSString* documentsDirPath = [dirArray objectAtIndex:<span class="number">0</span>];  </span><br><span class="line">    <span class="comment">//设置归档文件的全路径  </span></span><br><span class="line">    filePath = [documentsDirPath stringByAppendingPathComponent:@<span class="string">"2048.archive"</span>];  </span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    NSMutableArray* arr=[NSMutableArray arrayWithCapacity:<span class="number">64</span>];  </span><br><span class="line"><span class="comment">//    [arr addObject:[NSNumber numberWithInt:n ]];  </span></span><br><span class="line">    [arr addObject:[NSNumber numberWithInt:sco]];  </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)  </span><br><span class="line">            [arr addObject:[NSNumber numberWithInt:a[i][j] ]];  </span><br><span class="line">    [arr writeToFile:filePath atomically:YES];<span class="comment">//@"/tmp/2048.txt"  </span></span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(BOOL)game_over <span class="comment">//游戏结束  </span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">int</span> i,j;  </span><br><span class="line">    <span class="keyword">if</span>(count) <span class="keyword">return</span> NO;  </span><br><span class="line">    <span class="keyword">for</span>(  i=<span class="number">0</span>;i&lt;n ;i++)  </span><br><span class="line">        <span class="keyword">for</span>(  j=<span class="number">0</span>;j&lt;n-<span class="number">1</span>;j++)  </span><br><span class="line">            <span class="keyword">if</span>(a[i][j]==a[i][j+<span class="number">1</span>])  </span><br><span class="line">                <span class="keyword">return</span> NO;  </span><br><span class="line">    <span class="keyword">for</span>(  i=<span class="number">0</span>;i&lt;n ;i++)  </span><br><span class="line">        <span class="keyword">for</span>(  j=<span class="number">0</span>;j&lt;n-<span class="number">1</span>;j++)  </span><br><span class="line">            <span class="keyword">if</span>(a[j][i]==a[j+<span class="number">1</span>][i])  </span><br><span class="line">                <span class="keyword">return</span> NO;  </span><br><span class="line">    <span class="keyword">return</span>  YES;  </span><br><span class="line">&#125;  </span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h2 id="u8FD9_u6837_u4E4B_u540E_uFF0C_u6211_u4EEC_u53EA_u9700_u8981_u521B_u5EFA_u754C_u9762_uFF0C_u5C06_u6570_u7EC4_u5143_u7D20_u663E_u793A_u5BF9_u5E94_u7684lable_u4E0A_uFF0C_u5BF9_u5E94_u7684_u64CD_u4F5C_u8C03_u7528_u5BF9_u5E94_u7684_u65B9_u6CD5_u3002"><a href="#u8FD9_u6837_u4E4B_u540E_uFF0C_u6211_u4EEC_u53EA_u9700_u8981_u521B_u5EFA_u754C_u9762_uFF0C_u5C06_u6570_u7EC4_u5143_u7D20_u663E_u793A_u5BF9_u5E94_u7684lable_u4E0A_uFF0C_u5BF9_u5E94_u7684_u64CD_u4F5C_u8C03_u7528_u5BF9_u5E94_u7684_u65B9_u6CD5_u3002" class="headerlink" title="这样之后，我们只需要创建界面，将数组元素显示对应的lable上，对应的操作调用对应的方法。"></a>这样之后，我们只需要创建界面，将数组元素显示对应的lable上，对应的操作调用对应的方法。</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#import <span class="string">"Myui.h"</span>  </span></span><br><span class="line"><span class="preprocessor">#import <span class="string">"game.h"</span>  </span></span><br><span class="line">  </span><br><span class="line">@implementation Myui  </span><br><span class="line">@synthesize x;  </span><br><span class="line">- (id)initWithFrame:(CGRect)frame  </span><br><span class="line">&#123;  </span><br><span class="line">    self = [super initWithFrame:frame];  </span><br><span class="line">    <span class="keyword">if</span> (self) &#123;  </span><br><span class="line">        mygame=[[game alloc]initWithfirst:<span class="number">4</span>];  </span><br><span class="line">        <span class="keyword">int</span> tags=<span class="number">1</span>;  </span><br><span class="line">        score=<span class="number">0</span>;  </span><br><span class="line">          </span><br><span class="line">        UILabel* lable1=[[UILabel alloc]init];  </span><br><span class="line">        UILabel* lable2=[[UILabel alloc]init];  </span><br><span class="line">        UILabel* lable3=[[UILabel alloc]init];  </span><br><span class="line">        UILabel* lable4=[[UILabel alloc]init];  </span><br><span class="line">        lable1.frame=CGRectMake(<span class="number">10</span>, <span class="number">40</span>, <span class="number">80</span>, <span class="number">40</span>);  </span><br><span class="line">        lable2.frame=CGRectMake(<span class="number">90</span>, <span class="number">40</span>, <span class="number">80</span>, <span class="number">40</span>);  </span><br><span class="line">        lable3.frame=CGRectMake(<span class="number">170</span>, <span class="number">40</span>, <span class="number">80</span>, <span class="number">40</span>);  </span><br><span class="line">        lable4.frame=CGRectMake(<span class="number">250</span>, <span class="number">40</span>, <span class="number">80</span>, <span class="number">40</span>);  </span><br><span class="line">        lable2.tag=<span class="number">44</span>;  </span><br><span class="line">        lable4.tag=<span class="number">44</span>;  </span><br><span class="line">        [lable2 setText:@<span class="string">"0"</span>];  </span><br><span class="line">        [lable1 setText:@<span class="string">"SCORE:"</span>];  </span><br><span class="line">        [lable3 setText:@<span class="string">"最高分:"</span>];  </span><br><span class="line">          </span><br><span class="line">        [mygame initWithFile];  </span><br><span class="line">          </span><br><span class="line">        NSString* max=[NSString alloc];  </span><br><span class="line">        max=[NSString stringWithFormat:@<span class="string">"%d"</span>,mygame-&gt;sco];  </span><br><span class="line">          </span><br><span class="line">        [lable4 setText:max];  </span><br><span class="line">        [lable2 setFont:[UIFont boldSystemFontOfSize:<span class="number">24</span>]];  </span><br><span class="line">        [lable4 setFont:[UIFont boldSystemFontOfSize:<span class="number">24</span>]];  </span><br><span class="line">        [self addSubview:lable1];  </span><br><span class="line">        [self addSubview:lable2];  </span><br><span class="line">        [self addSubview:lable3];  </span><br><span class="line">        [self addSubview:lable4];  </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++) &#123;  </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>; j++) &#123;  </span><br><span class="line">                NSString* nr=[NSString alloc];  </span><br><span class="line">                nr=[NSString stringWithFormat:@<span class="string">"%d"</span>,mygame-&gt;a[i][j]];  </span><br><span class="line">                UILabel* views=[[UILabel alloc]init];  </span><br><span class="line">                views.frame=CGRectMake(<span class="number">80</span>*j, <span class="number">80</span>*i+<span class="number">140</span>, <span class="number">79</span>, <span class="number">79</span>);  </span><br><span class="line">                [views setText:nr];  </span><br><span class="line">                [self addSubview:views];  </span><br><span class="line">                views.backgroundColor=[UIColor colorWithRed:<span class="number">200</span> green:<span class="number">180</span> blue:<span class="number">50</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">                views.tag=tags;  </span><br><span class="line">                tags++;  </span><br><span class="line">                [views setTextAlignment:NSTextAlignmentCenter];  </span><br><span class="line">                [views setFont:[UIFont boldSystemFontOfSize:<span class="number">24</span>]];  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;  </span><br><span class="line">        [self drawRect:<span class="number">1</span>];  </span><br><span class="line">          </span><br><span class="line">        <span class="keyword">if</span>(self.gestL==nil)  </span><br><span class="line">        &#123;  </span><br><span class="line">            self.gestL=[[UISwipeGestureRecognizer alloc]initWithTarget:self action:@selector(fL:)];  </span><br><span class="line">            [self.gestL setDirection:UISwipeGestureRecognizerDirectionLeft];  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">if</span>(self.gestR==nil)  </span><br><span class="line">        &#123;  </span><br><span class="line">            self.gestR=[[UISwipeGestureRecognizer alloc]initWithTarget:self action:@selector(fR:)];  </span><br><span class="line">            [self.gestR setDirection:UISwipeGestureRecognizerDirectionRight];  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">if</span>(self.gestU==nil)  </span><br><span class="line">        &#123;  </span><br><span class="line">            self.gestU=[[UISwipeGestureRecognizer alloc]initWithTarget:self action:@selector(fU:)];  </span><br><span class="line">            [self.gestU setDirection:UISwipeGestureRecognizerDirectionUp];  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="keyword">if</span>(self.gestD==nil)  </span><br><span class="line">        &#123;  </span><br><span class="line">            self.gestD=[[UISwipeGestureRecognizer alloc]initWithTarget:self action:@selector(fD:)];  </span><br><span class="line">            [self.gestD setDirection:UISwipeGestureRecognizerDirectionDown];  </span><br><span class="line">        &#125;  </span><br><span class="line">          </span><br><span class="line">        [self addGestureRecognizer:self.gestL];  </span><br><span class="line">        [self addGestureRecognizer:self.gestR];  </span><br><span class="line">        [self addGestureRecognizer:self.gestU];  </span><br><span class="line">        [self addGestureRecognizer:self.gestD];  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> self;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)drawRect:(<span class="keyword">int</span>)id  </span><br><span class="line">&#123;  </span><br><span class="line">    <span class="keyword">int</span> tags=<span class="number">1</span>;  </span><br><span class="line">    score=<span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++) &#123;  </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>; j++) &#123;  </span><br><span class="line">            NSString* nr=[NSString alloc];  </span><br><span class="line">            nr=[NSString stringWithFormat:@<span class="string">"%d"</span>,mygame-&gt;a[i][j]];  </span><br><span class="line">            score+=mygame-&gt;a[i][j];  </span><br><span class="line">             </span><br><span class="line">            UILabel* nextLabel=(UILabel*)[self viewWithTag:tags];  </span><br><span class="line">              </span><br><span class="line">            nextLabel.layer.cornerRadius = <span class="number">10</span>;  </span><br><span class="line">            <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">0</span>)  </span><br><span class="line">                [nextLabel setText:nil];  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">                 [nextLabel setText:nr];  </span><br><span class="line">            <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">2</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">219.0</span>/<span class="number">255.0</span> green:<span class="number">216.0</span>/<span class="number">255.0</span> blue:<span class="number">185.0</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>];  </span><br><span class="line">                nextLabel.textColor=[UIColor colorWithRed:<span class="number">0.0</span>/<span class="number">255.0</span> green:<span class="number">0.0</span>/<span class="number">255.0</span> blue:<span class="number">0.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">4</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">233.0</span>/<span class="number">255.0</span> green:<span class="number">208.0</span>/<span class="number">255.0</span> blue:<span class="number">187.0</span>/<span class="number">255.0</span> alpha:<span class="number">1</span>];  </span><br><span class="line">                nextLabel.textColor=[UIColor colorWithRed:<span class="number">0.0</span>/<span class="number">255.0</span> green:<span class="number">0.0</span>/<span class="number">255.0</span> blue:<span class="number">0.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">8</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">249.0</span>/<span class="number">255.0</span> green:<span class="number">140.0</span>/<span class="number">255.0</span> blue:<span class="number">53.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            nextLabel.textColor=[UIColor colorWithRed:<span class="number">255.0</span>/<span class="number">255.0</span> green:<span class="number">255.0</span>/<span class="number">255.0</span> blue:<span class="number">255.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">16</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">240.0</span>/<span class="number">255.0</span> green:<span class="number">101.0</span>/<span class="number">255.0</span> blue:<span class="number">33.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">                nextLabel.textColor=[UIColor colorWithRed:<span class="number">255.0</span>/<span class="number">255.0</span> green:<span class="number">255.0</span>/<span class="number">255.0</span> blue:<span class="number">255.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">32</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">248.0</span>/<span class="number">255.0</span> green:<span class="number">89.0</span>/<span class="number">255.0</span> blue:<span class="number">47.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">                nextLabel.textColor=[UIColor colorWithRed:<span class="number">255.0</span>/<span class="number">255.0</span> green:<span class="number">255.0</span>/<span class="number">255.0</span> blue:<span class="number">255.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">64</span>)  </span><br><span class="line">            &#123;nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">251.0</span>/<span class="number">255.0</span> green:<span class="number">57.0</span>/<span class="number">255.0</span> blue:<span class="number">26.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">                nextLabel.textColor=[UIColor colorWithRed:<span class="number">255.0</span>/<span class="number">255.0</span> green:<span class="number">255.0</span>/<span class="number">255.0</span> blue:<span class="number">255.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">128</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">252.0</span>/<span class="number">255.0</span> green:<span class="number">229.0</span>/<span class="number">255.0</span> blue:<span class="number">102.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">                nextLabel.textColor=[UIColor colorWithRed:<span class="number">255.0</span>/<span class="number">255.0</span> green:<span class="number">255.0</span>/<span class="number">255.0</span> blue:<span class="number">255.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mygame-&gt;a[i][j]==<span class="number">256</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">100.0</span>/<span class="number">255.0</span> green:<span class="number">228.0</span>/<span class="number">255.0</span> blue:<span class="number">43.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">                nextLabel.textColor=[UIColor colorWithRed:<span class="number">255.0</span>/<span class="number">255.0</span> green:<span class="number">255.0</span>/<span class="number">255.0</span> blue:<span class="number">255.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mygame-&gt;a[i][j]&gt;=<span class="number">512</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">                nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">221.0</span>/<span class="number">255.0</span> green:<span class="number">43.0</span>/<span class="number">255.0</span> blue:<span class="number">228.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">                nextLabel.textColor=[UIColor colorWithRed:<span class="number">255.0</span>/<span class="number">255.0</span> green:<span class="number">255.0</span>/<span class="number">255.0</span> blue:<span class="number">255.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.8</span>];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">            nextLabel.backgroundColor=[UIColor colorWithRed:<span class="number">219.0</span>/<span class="number">255.0</span> green:<span class="number">216.0</span>/<span class="number">255.0</span> blue:<span class="number">185.0</span>/<span class="number">255.0</span> alpha:<span class="number">0.6</span>];  </span><br><span class="line">              </span><br><span class="line">            [UIView beginAnimations:@<span class="string">"doflip"</span> context:nil];  </span><br><span class="line">            <span class="comment">//设置时常  </span></span><br><span class="line">            [UIView setAnimationDuration:<span class="number">0.5</span>];  </span><br><span class="line">            <span class="comment">//设置动画淡入淡出  </span></span><br><span class="line">            [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];  </span><br><span class="line">            <span class="comment">//设置代理  </span></span><br><span class="line">            [UIView setAnimationDelegate:self];  </span><br><span class="line">            <span class="comment">//设置翻转方向  </span></span><br><span class="line">            <span class="keyword">if</span>(id==<span class="number">1</span>)  </span><br><span class="line">            &#123;  </span><br><span class="line">            [UIView setAnimationTransition:  </span><br><span class="line">             UIViewAnimationTransitionFlipFromLeft  forView:nextLabel cache:YES];  </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(id==<span class="number">2</span>)  </span><br><span class="line">                [UIView setAnimationTransition:  </span><br><span class="line">                 UIViewAnimationTransitionFlipFromRight  forView:nextLabel cache:YES];  </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(id==<span class="number">3</span>)  </span><br><span class="line">                [UIView setAnimationTransition:  </span><br><span class="line">                 UIViewAnimationTransitionCurlUp  forView:nextLabel cache:YES];  </span><br><span class="line">            <span class="keyword">else</span>  </span><br><span class="line">                [UIView setAnimationTransition:  </span><br><span class="line">                 UIViewAnimationTransitionCurlDown  forView:nextLabel cache:YES];  </span><br><span class="line">              </span><br><span class="line">            <span class="comment">//动画结束  </span></span><br><span class="line">            [UIView commitAnimations];  </span><br><span class="line">  </span><br><span class="line">            tags++;  </span><br><span class="line">            [nextLabel setTextAlignment:NSTextAlignmentCenter];  </span><br><span class="line">            [nextLabel setFont:[UIFont boldSystemFontOfSize:<span class="number">24</span>]];  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    UILabel* lable3=(UILabel*)[self viewWithTag:<span class="number">44</span>];  </span><br><span class="line">    NSString* sc=[NSString alloc];  </span><br><span class="line">    sc=[NSString stringWithFormat:@<span class="string">"%d"</span>,score];  </span><br><span class="line">    [lable3 setText:sc];  </span><br><span class="line">&#125;  </span><br><span class="line">-(<span class="keyword">void</span>)dealloc<span class="comment">//释放  </span></span><br><span class="line">&#123;  </span><br><span class="line">    [self.gestL release];  </span><br><span class="line">    [self.gestR release];  </span><br><span class="line">    [self.gestU release];  </span><br><span class="line">    [self.gestD release];  </span><br><span class="line">    [mygame release];  </span><br><span class="line">    [super  dealloc];  </span><br><span class="line">&#125;  </span><br><span class="line">-(<span class="keyword">void</span>)fL:(UISwipeGestureRecognizer*)g  </span><br><span class="line">&#123;  </span><br><span class="line">    [mygame move:<span class="number">3</span>];  </span><br><span class="line">    [self drawRect:<span class="number">1</span>];  </span><br><span class="line">    <span class="keyword">if</span> ([mygame game_over]==YES)  </span><br><span class="line">        [self gameOver];  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)fR:(UISwipeGestureRecognizer*)g  </span><br><span class="line">&#123;  </span><br><span class="line">    [mygame move:<span class="number">4</span>];  </span><br><span class="line">    [self drawRect:<span class="number">2</span>];  </span><br><span class="line">    <span class="keyword">if</span> ([mygame game_over]==YES)  </span><br><span class="line">        [self gameOver];  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)fU:(UISwipeGestureRecognizer*)g  </span><br><span class="line">&#123;  </span><br><span class="line">    [mygame move:<span class="number">1</span>];  </span><br><span class="line">    [self drawRect:<span class="number">3</span>];  </span><br><span class="line">    <span class="keyword">if</span> ([mygame game_over]==YES)  </span><br><span class="line">        [self gameOver];  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)fD:(UISwipeGestureRecognizer*)g  </span><br><span class="line">&#123;  </span><br><span class="line">    [mygame move:<span class="number">2</span>];  </span><br><span class="line">    [self drawRect:<span class="number">4</span>];  </span><br><span class="line">    <span class="keyword">if</span> ([mygame game_over]==YES)  </span><br><span class="line">        [self gameOver];  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">-(<span class="keyword">void</span>)gameOver  </span><br><span class="line">&#123;  </span><br><span class="line">    self.gestL=nil;  </span><br><span class="line">    self.gestR=nil;  </span><br><span class="line">    self.gestU=nil;  </span><br><span class="line">    self.gestD=nil;  </span><br><span class="line">    NSString *str=[NSString stringWithFormat:@<span class="string">"最终成绩：%d分"</span>,score];  </span><br><span class="line">    [mygame initWithFile];  </span><br><span class="line">    <span class="keyword">if</span>(score&gt;mygame-&gt;sco)  </span><br><span class="line">    &#123;  </span><br><span class="line">        mygame-&gt;sco=score;  </span><br><span class="line">        [mygame write_to_file];  </span><br><span class="line">    &#125;  </span><br><span class="line">    UIAlertView* info=[[UIAlertView alloc]initWithTitle:@<span class="string">"游戏结束"</span> message:str delegate:self cancelButtonTitle:@<span class="string">"确认"</span> otherButtonTitles:nil, nil nil];  </span><br><span class="line">    [info show];  </span><br><span class="line">    [mygame initWithfirst:<span class="number">4</span>];  </span><br><span class="line">    [self drawRect:<span class="number">1</span>];  </span><br><span class="line">&#125;<span class="comment">/* </span><br><span class="line">// Only override drawRect: if you perform custom drawing. </span><br><span class="line">// An empty implementation adversely affects performance during animation. </span><br><span class="line">- (void)drawRect:(CGRect)rect </span><br><span class="line">&#123; </span><br><span class="line">    // Drawing code </span><br><span class="line">&#125; </span><br><span class="line">*/</span>  </span><br><span class="line">  </span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<h2 id="u8FD9_u6837_u5C31_u5B8C_u6210_u4E862048"><a href="#u8FD9_u6837_u5C31_u5B8C_u6210_u4E862048" class="headerlink" title="这样就完成了2048"></a>这样就完成了2048</h2><h2 id="u8FD9_u662F_u81EA_u5DF1_u5F88_u4E45_u4E4B_u524D_u968F_u610F_u5199_u7684_uFF0C_u73B0_u5728_u81EA_u5DF1_u770B_u770B_u4EE3_u7801_u90FD_u60F3_u7B11_u3002_u601D_u8DEF_u5927_u5BB6_u61C2_u5C31_u597D_u4E86_u3002"><a href="#u8FD9_u662F_u81EA_u5DF1_u5F88_u4E45_u4E4B_u524D_u968F_u610F_u5199_u7684_uFF0C_u73B0_u5728_u81EA_u5DF1_u770B_u770B_u4EE3_u7801_u90FD_u60F3_u7B11_u3002_u601D_u8DEF_u5927_u5BB6_u61C2_u5C31_u597D_u4E86_u3002" class="headerlink" title="这是自己很久之前随意写的，现在自己看看代码都想笑。思路大家懂就好了。"></a>这是自己很久之前随意写的，现在自己看看代码都想笑。思路大家懂就好了。</h2>
  </section>

  
  
</article>


            <footer class="footer">

    <span class="footer__copyright">&copy; 2014-2015. | 由<a href="https://hexo.io/">Hexo</a>强力驱动 | 主题<a href="https://github.com/someus/huno">Huno</a></span>
    
</footer>
        </div>
    </div>

    <!-- js files -->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/scale.fix.js"></script>
    

    

    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript"> 
        $(document).ready(function(){
            MathJax.Hub.Config({ 
                tex2jax: {inlineMath: [['[latex]','[/latex]'], ['\\(','\\)']]} 
            });
        });
    </script>


    

    <script src="/js/awesome-toc.min.js"></script>
    <script>
        $(document).ready(function(){
            $.awesome_toc({
                overlay: true,
                contentId: "post-content",
            });
        });
    </script>


    
    
    <!--kill ie6 -->
<!--[if IE 6]>
  <script src="//letskillie6.googlecode.com/svn/trunk/2/zh_CN.js"></script>
<![endif]-->

</body>
</html>
